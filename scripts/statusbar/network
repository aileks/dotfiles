#!/bin/sh

connection=$(nmcli -t -f NAME,TYPE connection show --active 2>/dev/null | grep -E 'wifi|ethernet' | head -1 | cut -d: -f1)

if [ -z "$connection" ]; then
    icon="󰤭"
    color="#L535353"
    printf "^c%s^%s^d^" "$color" "$icon"
    exit 0
fi

type=$(nmcli -t -f NAME,TYPE connection show --active 2>/dev/null | grep -E 'wifi|ethernet' | head -1 | cut -d: -f2)

if [ "$type" = "802-11-wireless" ]; then
    signal=$(nmcli -t -f IN-USE,SIGNAL dev wifi 2>/dev/null | grep '^\*' | cut -d: -f2)
    if [ -n "$signal" ] && [ "$signal" -ge 70 ]; then
        icon="󰤨"
        color="#L4A8B8B"
    elif [ -n "$signal" ] && [ "$signal" -ge 40 ]; then
        icon="󰤥"
        color="#La7a7a7"
    else
        icon="󰤟"
        color="#LE49A44"
    fi
else
    icon="󰈀"
    color="#L4A8B8B"
fi

printf "^c%s^%s^d^" "$color" "$icon"
